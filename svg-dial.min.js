!function(t){var i="object"==typeof self&&self.self==self&&self||"object"==typeof global&&global.global==global&&global;if("function"==typeof define&&define.amd)define(["snap","exports"],function(e,n){i.DialKnob=t(i,n,e)});else if("undefined"!=typeof exports){var e=require("snapsvg");t(i,exports,e)}else i.DialKnob=t(i,{},i.Snap)}(function(t,i,e){var n=function(t,i,e){var n=t%90/90;return i*(1-n)+e*n},r=function(t){return t>=0&&90>t?[n(t,0,8),n(t,8,0)]:t>=90&&180>t?[n(t,8,0),n(t,0,-8)]:t>=180&&270>t?[n(t,0,-8),n(t,-8,0)]:[n(t,-8,0),n(t,0,8)]};return i.DialKnob=function(t,i){this.elSelector=t||"#svg-dial",this.options=this.defaults(i||{}),this.initialize()},i.DialKnob.prototype={defaults:function(t){var i={frameBackgroundColor:"white",frameSize:200,ringBackground:"#888",innerBackground:"white",textFontFamily:"impact",textFontSize:"24px",ringWidth:50};for(key in t)i[key]=t[key];return i},initialize:function(){this.c=this.buildCanvas(),this.dial=this.buildDial(),dragOnMove=function(t,i,e,n,r){this._updateDial(e,n),this._executeCallback("onDragMove",[this.percentage])},dragOnStart=function(t,i,e){this._updateDial(t,i),this._executeCallback("onDragStart",[this.percentage])},dragOnEnd=function(t,i,e){this._executeCallback("onDragEnd",[this.percentage])},this._moveKnob(this._convertPercentageToAngle(0)),this.innerCircle.drag(dragOnMove,dragOnStart,dragOnEnd,this,this,this),this.outerCircle.drag(dragOnMove,dragOnStart,dragOnEnd,this,this,this),this._executeCallback("onReady")},buildCanvas:function(){return e(this.elSelector)},buildDial:function(){this.outerCircle=this.buildOuterCircle(),this.innerCircle=this.buildInnerCircle(),this.text=this.buildText()},buildOuterCircle:function(){var t=this.outerCircleAttributes={x:this.options.frameSize/2,y:this.options.frameSize/2,radius:this.options.frameSize/2},i=function(t){return[0,0,0,t,t/2,t/2,t,t,t,0]},e=this.c.circle(t.x,t.y,t.radius);return e.attr({fill:this.c.gradient(this._calculateFillColor(this.options.background)),mask:this.c.polyline(i(this.options.frameSize)).attr({fill:this.options.frameBackgroundColor})}),e},buildInnerCircle:function(){var t=this.innerCircleAttributes={x:this.outerCircleAttributes.x,y:this.outerCircleAttributes.y,radius:this.outerCircleAttributes.radius-this.options.ringWidth},i=function(){var i,e,n=this.options.ringWidth+5,r=t.x-t.radius+5;return i=this.outerCircleAttributes.radius+.5*n,e=this.outerCircleAttributes.radius-.5*n,this.c.polyline(r,e,r,i,r-n,this.outerCircleAttributes.radius)},n=this.c.circle(t.x,t.y,t.radius),r=this.c.filter(e.filter.shadow(0,this.options.ringWidth/10,this.options.ringWidth/10,"#000",.6)),o=i.call(this);return n=this.c.group(n,o).attr({fill:this._calculateFillColor(this.options.innerBackground),filter:r,transform:["rotate(0",this.options.frameSize/2,this.options.frameSize/2].join(" ")})},buildText:function(){return this.c.text(this.options.frameSize/2,this.options.frameSize/2,"0%").attr({fontFamily:this.options.textFontFamily,fontSize:this.options.textFontSize,textAnchor:"middle"})},_updateText:function(t){this.text.attr({text:[Math.round(100*t),"%"].join("")})},_calculateFillColor:function(t){return t=t instanceof Array?t:[t],"l(0, 0.5, 1, 0.5)"+t.join("-")},_convertAngleToPercentage:function(t){var i,e=315,n=225;return i=t>e&&360>=t?45-(360-t):t+45,i/(n+45)},_convertPercentageToAngle:function(t){var i=315,e=225;return unadjustedAngle=t*(e+45)+i,unadjustedAngle>360?unadjustedAngle-360:unadjustedAngle},_moveKnob:function(t){var i=r(t),n=this.c.filter(e.filter.shadow(i[0],i[1],this.options.ringWidth/10,"#000",.6));this.innerCircle.attr({transform:["rotate(",t,this.options.frameSize/2,this.options.frameSize/2,")"].join(" "),filter:n})},_updateDial:function(t,i){var n=e.angle(this.options.frameSize/2,this.options.frameSize/2,t,i);315>=n&&n>225||(this._moveKnob(n),this.percentage=this._convertAngleToPercentage(n),this._updateText(this.percentage))},_executeCallback:function(t,i){this.options[t]&&this.options[t].apply(this,i)}},i.DialKnob});