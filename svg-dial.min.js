!function(t){var e="object"==typeof self&&self.self==self&&self||"object"==typeof global&&global.global==global&&global;if("function"==typeof define&&define.amd)define(["snap","exports"],function(i,n){e.DialKnob=t(e,n,i)});else if("undefined"!=typeof exports){var i=require("snapsvg");t(e,exports,i)}else e.DialKnob=t(e,{},e.Snap)}(function(t,e,i){var n=function(t,e,i){var n=t%90/90;return e*(1-n)+i*n},r=function(t){return t>=0&&90>t?[n(t,0,8),n(t,8,0)]:t>=90&&180>t?[n(t,8,0),n(t,0,-8)]:t>=180&&270>t?[n(t,0,-8),n(t,-8,0)]:[n(t,-8,0),n(t,0,8)]},o=function(t,e){var i={};for(key in e)i[key]=e[key];for(key in t)i[key]=t[key];return i};return e.DialKnob=function(t,e){this.el=t||"#svg-dial",this.options=o(e||{},{frameBackgroundColor:"white",frameSize:200,ringBackground:"#888",innerBackground:"white",textFontFamily:"impact",textFontSize:"24px",textFontStyle:"none",textFontWeight:"none",ringWidth:50}),this.initialize()},e.DialKnob.create=function(t,i){return new e.DialKnob(t,i)},e.DialKnob.prototype={setValue:function(t){var e=this.convertPercentageToAngle(t);this.updateDial(e)},initialize:function(){this.c=this.buildCanvas(),this.dial=this.buildDial(),dragOnMove=function(t,e,i,n,r){this.updateDial(this.getAngle(i,n)),this.executeCallback("onDragMove",[this.percentage])},dragOnStart=function(t,e,i){this.centerCoordinates=this.calculateDialCenterCoordinates(),this.updateDial(this.getAngle(t,e)),this.executeCallback("onDragStart",[this.percentage])},dragOnEnd=function(t,e,i){this.executeCallback("onDragEnd",[this.percentage])},this.moveKnob(this.convertPercentageToAngle(0)),this.innerCircle.drag(dragOnMove,dragOnStart,dragOnEnd,this,this,this),this.outerCircle.drag(dragOnMove,dragOnStart,dragOnEnd,this,this,this),this.executeCallback("onReady")},getAngle:function(t,e){return i.angle(this.centerCoordinates.x,this.centerCoordinates.y,t,e)},buildCanvas:function(){var t;t=this.el.jquery?this.el[0]:this.el instanceof HTMLElement?this.el:document.querySelector(this.el);var e='<svg style="width: '+this.options.frameSize+"px; height: "+this.options.frameSize+'px;"></svg>';return t.innerHTML=e,i(t.getElementsByTagName("svg")[0])},buildDial:function(){this.outerCircle=this.buildOuterCircle(),this.innerCircle=this.buildInnerCircle(),this.text=this.buildText()},buildOuterCircle:function(){var t=this.outerCircleAttributes={x:this.options.frameSize/2,y:this.options.frameSize/2,radius:this.options.frameSize/2},e=function(t){return[0,0,0,t,t/2,t/2,t,t,t,0]},i=this.c.circle(t.x,t.y,t.radius);return i.attr({fill:this.c.gradient(this.calculateFillColor(this.options.background)),mask:this.c.polyline(e(this.options.frameSize)).attr({fill:this.options.frameBackgroundColor})}),i},buildInnerCircle:function(){var t=this.innerCircleAttributes={x:this.outerCircleAttributes.x,y:this.outerCircleAttributes.y,radius:this.outerCircleAttributes.radius-this.options.ringWidth},e=function(){var e,i,n=this.options.ringWidth+5,r=t.x-t.radius+5;return e=this.outerCircleAttributes.radius+.5*n,i=this.outerCircleAttributes.radius-.5*n,this.c.polyline(r,i,r,e,r-n,this.outerCircleAttributes.radius)},i=this.c.circle(t.x,t.y,t.radius),n=this.generateDropShadow(),r=e.call(this);return i=this.c.group(i,r).attr({fill:this.calculateFillColor(this.options.innerBackground),filter:n,transform:["rotate(0",this.options.frameSize/2,this.options.frameSize/2].join(" ")})},buildText:function(){return this.c.text(this.options.frameSize/2,this.options.frameSize/2+this.options.textFontSize/3,"0%").attr({fontFamily:this.options.textFontFamily,fontSize:this.options.textFontSize,fontWeight:this.options.textFontWeight,fontStyle:this.options.textFontStyle,textAnchor:"middle"})},generateDropShadow:function(t){var e=o(t||{},{x:0,y:this.options.ringWidth/20,blur:3,color:"#000",opacity:.2});return this.c.filter(i.filter.shadow(e.x,e.y,e.blur,e.color,e.opacity))},updateText:function(t){this.text.attr({text:[Math.round(100*t),"%"].join("")})},calculateFillColor:function(t){return t=t instanceof Array?t:[t],"l(0, 0.5, 1, 0.5)"+t.join("-")},convertAngleToPercentage:function(t){var e,i=315,n=225;return e=t>i&&360>=t?45-(360-t):t+45,e/(n+45)},convertPercentageToAngle:function(t){var e=315,i=225;return unadjustedAngle=t*(i+45)+e,unadjustedAngle>360?unadjustedAngle-360:unadjustedAngle},moveKnob:function(t){var e=r(t),i=this.generateDropShadow({x:e[0],y:e[1]});this.innerCircle.attr({transform:["rotate(",t,this.options.frameSize/2,this.options.frameSize/2,")"].join(" "),filter:i})},updateDial:function(t){315>=t&&t>225||(this.moveKnob(t),this.percentage=this.convertAngleToPercentage(t),this.updateText(this.percentage))},calculateDialCenterCoordinates:function(){var t=this.outerCircle.node.getBoundingClientRect();return{x:t.left+t.height/2,y:t.top+t.height/2}},executeCallback:function(t,e){this.options[t]&&this.options[t].apply(null,e)}},e.DialKnob});